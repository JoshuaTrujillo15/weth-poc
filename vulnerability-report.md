# Vulnerability Report

## Symbolic Execution Trace

```
Starting symbolic execution step...
2022-05-30 07:16:14 cs-36042793510-default pakala.sm[811] WARNING Fuzzer got used (forced concretization). We will lose accuracy and risk state explosion.
2022-05-30 07:16:22 cs-36042793510-default pakala.sm[811] INFO_INTERACTIVE Coverage now 82%. Queue size 18. Got 8 outcomes.
2022-05-30 07:16:25 cs-36042793510-default pakala.sm[811] INFO_INTERACTIVE Coverage now 90%. Queue size 15. Got 12 outcomes.
2022-05-30 07:16:27 cs-36042793510-default pakala.sm[811] INFO_INTERACTIVE Coverage now 92%. Queue size 12. Got 15 outcomes.
2022-05-30 07:16:33 cs-36042793510-default pakala.sm[811] INFO_INTERACTIVE Coverage now 94%. Queue size 16. Got 16 outcomes.
2022-05-30 07:16:59 cs-36042793510-default pakala.sm[811] INFO_INTERACTIVE Coverage now 95%. Queue size 16. Got 20 outcomes.
2022-05-30 07:17:08 cs-36042793510-default pakala.sm[811] INFO_INTERACTIVE Coverage now 95%. Queue size 19. Got 20 outcomes.
2022-05-30 07:17:10 cs-36042793510-default pakala.sm[811] INFO_INTERACTIVE Coverage now 97%. Queue size 18. Got 21 outcomes.
2022-05-30 07:17:31 cs-36042793510-default pakala.sm[811] INFO_INTERACTIVE Coverage now 97%. Queue size 20. Got 24 outcomes.
2022-05-30 07:18:55 cs-36042793510-default pakala.sm[811] INFO_INTERACTIVE Coverage now 98%. Queue size 27. Got 32 outcomes.
2022-05-30 07:21:46 cs-36042793510-default pakala.sm[811] INFO Analysis finished with 54 outcomes (13 interesting, 34 unfinished), coverage is 98%
2022-05-30 07:21:46 cs-36042793510-default pakala.sm[811] INFO Interpreter errors encountered: [('execute timeout', 1)]
Symbolic execution finished with coverage 98%.
Outcomes: 13 interesting. 54 total and 34 unfinished paths.

Starting analysis step...
2022-05-30 07:22:06 cs-36042793510-default pakala.recursive_analyzer[811] INFO_INTERACTIVE Now scanning paths of length 1.
2022-05-30 07:22:07 cs-36042793510-default pakala.analyzer[811] WARNING Cannot list storage keys (ValueError). We will lose a bit of accuracy. Try to use a node that supports the parity_listStorageKeys RPC. 
2022-05-30 07:22:09 cs-36042793510-default pakala.analyzer[811] INFO Loaded 10 storage slots from the contract (non-exhaustive). 3 non-zero.
2022-05-30 07:22:29 cs-36042793510-default pakala.recursive_analyzer[811] INFO_INTERACTIVE Now scanning paths of length 2.
2022-05-30 07:25:29 cs-36042793510-default pakala.analyzer[811] INFO Found call bug.
Path:

Transaction 1, symbolic state:
{'calls': [[<BV256 0x0>,
            <BV256 0x60>,
            <BV256 0x0>,
            <BV256 0x60>,
            <BV256 calldata[0]_310_256[223:0] .. calldata[32]_311_32>,
            <BV256 0xcafebabefffffffff0202fffffffff7cff7247c9>,
            <BV256 (if calldata[0]_310_256[223:0] .. calldata[32]_311_32 == 0x0 then 0x1 else 0x0) * 0x8fc>]],
 'env': {'balance': <BV256 0x4caa3c6a768242a3c88c0>,
         'caller': <BV256 0xcafebabefffffffff0202fffffffff7cff7247c9>,
         'value': <BV256 value_302_256>},
 'selfdestruct_to': None,
 'solver': {'constraints': [<Bool 0x4 <= calldata_size_306_256>,
                            <Bool calldata[0]_310_256[255:224] == 0x2e1a7d4d>,
                            <Bool value_302_256 == 0x0>,
                            <Bool calldata[0]_310_256[223:0] .. calldata[32]_311_32 <= storage[<BV256 SHA3(0xcafebabefffffffff0202fffffffff7cff7247c90000000000000000000000000000000000000000000000000000000000000003)>]_314_256>],
            'hashes': {}},
 'storage_read': {<BV256 SHA3(0xcafebabefffffffff0202fffffffff7cff7247c90000000000000000000000000000000000000000000000000000000000000003)>: <BV256 storage[<BV256 SHA3(0xcafebabefffffffff0202fffffffff7cff7247c90000000000000000000000000000000000000000000000000000000000000003)>]_314_256>},
 'storage_written': {<BV256 SHA3(0xcafebabefffffffff0202fffffffff7cff7247c90000000000000000000000000000000000000000000000000000000000000003)>: <BV256 storage[<BV256 SHA3(0xcafebabefffffffff0202fffffffff7cff7247c90000000000000000000000000000000000000000000000000000000000000003)>]_314_256 - calldata[0]_310_256[223:0] .. calldata[32]_311_32>}}

Transaction 1, example solution:
{'caller': '0xcafebabefffffffff0202fffffffff7cff7247c9',
 'data': '2e1a7d4d00000000000000000000000000000000000000000000000000038d7ea4c6800100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000',
 'value': 0}


Transaction 2, symbolic state:
{
"selfdestruct_to": None,
"calls": [],
"storage_written": {<BV256 SHA3(0xcafebabefffffffff0202fffffffff7cff7247c90000000000000000000000000000000000000000000000000000000000000003)>: <BV256 storage[<BV256 SHA3(0xcafebabefffffffff0202fffffffff7cff7247c90000000000000000000000000000000000000000000000000000000000000003)>]_1308_256 - calldata[36]_1304_256 + calldata[36]_1304_256>},
"storage_read": {<BV256 SHA3(0xcafebabefffffffff0202fffffffff7cff7247c90000000000000000000000000000000000000000000000000000000000000003)>: <BV256 storage[<BV256 SHA3(0xcafebabefffffffff0202fffffffff7cff7247c90000000000000000000000000000000000000000000000000000000000000003)>]_1308_256>},
"env": {'balance': <BV256 0x4caa3c6a768242a3c88c0>,
 'caller': <BV256 0xcafebabefffffffff0202fffffffff7cff7247c9>,
 'value': <BV256 value_1294_256>},
"solver": {'constraints': [<Bool 0x4 <= calldata_size_1298_256>, <Bool calldata[0]_1302_256[255:224] == 0xa9059cbb>, <Bool value_1294_256 == 0x0>, <Bool calldata[36]_1304_256 <= storage[<BV256 SHA3(0xcafebabefffffffff0202fffffffff7cff7247c90000000000000000000000000000000000000000000000000000000000000003)>]_1308_256>, <Bool SHA3_1306_256 == SHA3_1307_256>], 'hashes': {<BV512 0xcafebabefffffffff0202fffffffff7cff7247c90000000000000000000000000000000000000000000000000000000000000003>: <BV256 SHA3_1306_256>, <BV512 0xffffffffffffffffffffffffffffffffffffffff & calldata[0]_1302_256[223:0] .. calldata[32]_1303_32 .. 0x3>: <BV256 SHA3_1307_256>}},
}

Transaction 2, example solution:
{'caller': '0xcafebabefffffffff0202fffffffff7cff7247c9',
 'data': 'a9059cbb000000000000000000000000cafebabefffffffff0202fffffffff7cff7247c900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000',
 'value': 0}


======> Bug found! Need 2 transactions. <======
```

## Impact

...

## Proof of Concept

...

## Tools Used

- Foundry
- ...

## Recommended Mitigation Steps

...
